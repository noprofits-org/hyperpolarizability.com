<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Hyperpolarizability.com - Visualization of Compression Factor Behavior in Real Gases - A Virial Equation Approach</title>
        <link rel="stylesheet" href="../css/default.css" />
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="../js/mathjax-config.js"></script>
        <script src="../js/code-copy.js"></script>
        <script src="../js/print.js"></script>
    </head>
    <body>
        <header>
            <div class="header-content">
                <div class="logo">
                    <a href="../">Hyperpolarizability.com</a>
                </div>
                <nav>
                    <a href="../">Home</a>
                    <a href="../about.html">About</a>
                    <a href="../contact.html">Contact</a>
                    <a href="../archive.html">Archive</a>
                </nav>
            </div>
        </header>

        <main role="main">
            <div class="container">
                <h1>Visualization of Compression Factor Behavior in Real Gases - A Virial Equation Approach</h1>
                <article>
    <section class="header">
        Posted on April 20, 2025
        
        by Physical Chemistry Study Group
        
    </section>
    
    <section>
        <h2 id="abstract">Abstract</h2>
<p>This study presents a visualization of compression factor behavior for four common gases (N₂, Ar, CO₂, and CH₄) using the virial equation of state. Through calculations across temperatures (200K-600K) and pressures (1-200 bar), we demonstrate the transition from attraction-dominated to repulsion-dominated molecular interaction regimes. Our results capture how the second virial coefficient shifts from negative to positive values with increasing temperature, resulting in characteristic compression factor profiles unique to each gas. The analysis reveals that CO₂ exhibits the strongest deviations from ideality, while N₂ approaches ideal behavior near 300K. This computational approach provides a valuable educational tool for understanding real gas behavior, making abstract thermodynamic concepts tangible through data visualization.<span class="citation" data-cites="atkins2010physical"><sup>1</sup></span></p>
<h2 id="introduction">Introduction</h2>
<p>The behavior of real gases represents a foundational challenge in physical chemistry, requiring a framework that accounts for molecular interactions absent in the idealized perfect gas model. While the ideal gas law (PV = nRT) provides an elegant starting point, its utility is limited to conditions of low pressure and high temperature where molecular interactions are negligible. Under more extreme conditions, deviations from ideality become pronounced and demand more sophisticated treatment.</p>
<p>The virial equation of state has emerged as a powerful framework for understanding real gas behavior. As a systematic Taylor expansion of the ideal gas law, it introduces temperature-dependent coefficients that progressively account for increasingly complex molecular interactions. The second virial coefficient (B) primarily quantifies two-body interactions, while higher-order coefficients address more complex multi-molecular effects. This approach provides a direct connection between macroscopic thermodynamic properties and microscopic molecular interactions.</p>
<p>The compression factor (Z = PV/nRT) offers a particularly insightful metric for quantifying deviations from ideal behavior. For a perfect gas, Z = 1 under all conditions, while real gases exhibit values that deviate above or below unity depending on whether repulsive or attractive interactions dominate. This dimensionless parameter serves as a powerful indicator of the molecular interaction regime at any given state point.</p>
<p>The temperature dependence of the compression factor is especially revealing. At low temperatures, attractive forces typically dominate, resulting in Z &lt; 1. As temperature increases, the growing kinetic energy of molecules progressively overwhelms these attractive forces, eventually leading to conditions where repulsive forces dominate and Z &gt; 1. At a characteristic temperature known as the Boyle temperature (TB), the attractive and repulsive contributions balance, and the gas exhibits near-ideal behavior over an extended pressure range.</p>
<p>Despite the theoretical elegance of the virial equation approach, its implications can remain abstract without concrete visualization. The present study addresses this need by providing a systematic computational exploration of compression factor behavior across four common gases (N₂, Ar, CO₂, and CH₄) over a wide range of temperatures and pressures. By visualizing how Z varies with state conditions and correlating these variations with virial coefficients, we aim to provide a clear illustration of the transition between molecular interaction regimes. This experiment is designed to explore a pressure range (1-200 bar) relevant to many practical applications while spanning temperatures from 200K to 600K to capture the transition between attraction-dominated and repulsion-dominated regimes.</p>
<h2 id="experimental">Experimental</h2>
<p>The computational experiment was conducted on a Linux workstation (Ubuntu 24.04.2 LTS) using a conda environment (quantum_chem) equipped with essential scientific computing packages including NumPy, SciPy, Pandas, and Matplotlib. The system’s computational specifications (Intel Core i7-1165G7 CPU, 16GB RAM) were sufficient for the calculation requirements of this study.</p>
<p><strong>Code 1.</strong> The following Python script calculates compression factors for four different gases (N₂, Ar, CO₂, CH₄) across a range of pressures (1-200 bar) and temperatures (200K-600K) using the virial equation of state truncated after the third virial coefficient.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.gridspec <span class="im">import</span> GridSpec</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up figure parameters for publication-quality output</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'font.family'</span>] <span class="op">=</span> <span class="st">'DejaVu Serif'</span>  <span class="co"># Use a font that's likely installed</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'font.size'</span>] <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.figsize'</span>] <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">12</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Virial coefficients (cm³/mol) for different gases at different temperatures</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Data based on literature values</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>virial_data <span class="op">=</span> {</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'N2'</span>: {</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">'200K'</span>: {<span class="st">'B'</span>: <span class="op">-</span><span class="fl">160.0</span>, <span class="st">'C'</span>: <span class="dv">4800</span>},</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">'273K'</span>: {<span class="st">'B'</span>: <span class="op">-</span><span class="fl">10.5</span>, <span class="st">'C'</span>: <span class="dv">1200</span>},</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">'300K'</span>: {<span class="st">'B'</span>: <span class="fl">4.2</span>, <span class="st">'C'</span>: <span class="dv">1050</span>},</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">'400K'</span>: {<span class="st">'B'</span>: <span class="fl">21.3</span>, <span class="st">'C'</span>: <span class="dv">800</span>},</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">'600K'</span>: {<span class="st">'B'</span>: <span class="fl">35.1</span>, <span class="st">'C'</span>: <span class="dv">520</span>}</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Ar'</span>: {</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">'200K'</span>: {<span class="st">'B'</span>: <span class="op">-</span><span class="fl">187.0</span>, <span class="st">'C'</span>: <span class="dv">5600</span>},</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">'273K'</span>: {<span class="st">'B'</span>: <span class="op">-</span><span class="fl">21.7</span>, <span class="st">'C'</span>: <span class="dv">1200</span>},</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">'300K'</span>: {<span class="st">'B'</span>: <span class="op">-</span><span class="fl">5.3</span>, <span class="st">'C'</span>: <span class="dv">950</span>},</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">'400K'</span>: {<span class="st">'B'</span>: <span class="fl">19.4</span>, <span class="st">'C'</span>: <span class="dv">760</span>},</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">'600K'</span>: {<span class="st">'B'</span>: <span class="fl">32.6</span>, <span class="st">'C'</span>: <span class="dv">490</span>}</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CO2'</span>: {</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">'273K'</span>: {<span class="st">'B'</span>: <span class="op">-</span><span class="fl">142.0</span>, <span class="st">'C'</span>: <span class="dv">3400</span>},</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">'300K'</span>: {<span class="st">'B'</span>: <span class="op">-</span><span class="fl">114.8</span>, <span class="st">'C'</span>: <span class="dv">3100</span>},</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">'400K'</span>: {<span class="st">'B'</span>: <span class="op">-</span><span class="fl">49.2</span>, <span class="st">'C'</span>: <span class="dv">2300</span>},</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">'500K'</span>: {<span class="st">'B'</span>: <span class="op">-</span><span class="fl">13.3</span>, <span class="st">'C'</span>: <span class="dv">1800</span>},</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        <span class="st">'600K'</span>: {<span class="st">'B'</span>: <span class="fl">11.9</span>, <span class="st">'C'</span>: <span class="dv">1400</span>}</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CH4'</span>: {</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">'200K'</span>: {<span class="st">'B'</span>: <span class="op">-</span><span class="fl">148.2</span>, <span class="st">'C'</span>: <span class="dv">4200</span>},</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">'273K'</span>: {<span class="st">'B'</span>: <span class="op">-</span><span class="fl">53.6</span>, <span class="st">'C'</span>: <span class="dv">2300</span>},</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">'300K'</span>: {<span class="st">'B'</span>: <span class="op">-</span><span class="fl">42.3</span>, <span class="st">'C'</span>: <span class="dv">2100</span>},</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">'400K'</span>: {<span class="st">'B'</span>: <span class="op">-</span><span class="fl">9.1</span>, <span class="st">'C'</span>: <span class="dv">1400</span>},</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">'600K'</span>: {<span class="st">'B'</span>: <span class="fl">28.4</span>, <span class="st">'C'</span>: <span class="dv">780</span>}</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Gas constants</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>R <span class="op">=</span> <span class="fl">0.08314</span>  <span class="co"># L·bar/mol·K (convenient for pressure in bar)</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate Z using the virial equation with B and C</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_Z(pressure, temperature, B, C):</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># First calculate molar volume of ideal gas at these conditions</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    Vm_ideal <span class="op">=</span> R <span class="op">*</span> temperature <span class="op">/</span> pressure</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate Z using the virial equation truncated after C term</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    Z <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> (B <span class="op">*</span> <span class="fl">1e-3</span>) <span class="op">/</span> Vm_ideal <span class="op">+</span> (C <span class="op">*</span> <span class="fl">1e-6</span>) <span class="op">/</span> (Vm_ideal<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Z, Vm_ideal</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Pressure range for calculation (in bar)</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>pressures <span class="op">=</span> np.linspace(<span class="dv">1</span>, <span class="dv">200</span>, <span class="dv">100</span>)</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the figure with subplots</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>gs <span class="op">=</span> GridSpec(<span class="dv">2</span>, <span class="dv">2</span>, figure<span class="op">=</span>fig)</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> [fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">0</span>]), fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">1</span>]), </span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>        fig.add_subplot(gs[<span class="dv">1</span>, <span class="dv">0</span>]), fig.add_subplot(gs[<span class="dv">1</span>, <span class="dv">1</span>])]</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Colors for different temperatures</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> {</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">'200K'</span>: <span class="st">'blue'</span>,</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">'273K'</span>: <span class="st">'green'</span>,</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">'300K'</span>: <span class="st">'red'</span>,</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    <span class="st">'400K'</span>: <span class="st">'purple'</span>,</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    <span class="st">'500K'</span>: <span class="st">'orange'</span>,</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>    <span class="st">'600K'</span>: <span class="st">'brown'</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Store compression factor values at 100 bar for the table</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>table_data <span class="op">=</span> {}</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Z vs pressure for each gas</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, (gas, temp_data) <span class="kw">in</span> <span class="bu">enumerate</span>(virial_data.items()):</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> axes[idx]</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    table_data[gas] <span class="op">=</span> {}</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> temp, coef <span class="kw">in</span> temp_data.items():</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>        B <span class="op">=</span> coef[<span class="st">'B'</span>]</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>        C <span class="op">=</span> coef[<span class="st">'C'</span>]</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>        Z_values <span class="op">=</span> []</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>        temperature <span class="op">=</span> <span class="bu">float</span>(temp[:<span class="op">-</span><span class="dv">1</span>])  <span class="co"># Remove 'K' and convert to float</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate Z for each pressure</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> p <span class="kw">in</span> pressures:</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>            Z, Vm <span class="op">=</span> calculate_Z(p, temperature, B, C)</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>            Z_values.append(Z)</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Store Z at 100 bar for the table</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">abs</span>(p <span class="op">-</span> <span class="dv">100</span>) <span class="op">&lt;</span> <span class="fl">1.0</span>:  <span class="co"># Close to 100 bar</span></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>                table_data[gas][temp] <span class="op">=</span> Z</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Plot Z vs pressure</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>        ax.plot(pressures, Z_values, label<span class="op">=</span><span class="ss">f&quot;</span><span class="sc">{</span>temp<span class="sc">}</span><span class="ss"> (B=</span><span class="sc">{</span>B<span class="sc">}</span><span class="ss">)&quot;</span>, color<span class="op">=</span>colors[temp], </span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>                linestyle<span class="op">=</span><span class="st">'-'</span> <span class="cf">if</span> B <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">'--'</span>)</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add horizontal line at Z=1 (ideal gas behavior)</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>    ax.axhline(y<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">':'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Customize the plot</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f&quot;</span><span class="sc">{</span>gas<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">&quot;Pressure (bar)&quot;</span>)</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">&quot;Compression Factor (Z)&quot;</span>)</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(<span class="fl">0.4</span>, <span class="fl">1.6</span>)</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>    ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>    ax.legend(fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the figure</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'compression_factor_comparison.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'compression_factor_comparison.pdf'</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame for the tabular data</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a><span class="co"># First, get all temperatures used</span></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>all_temps <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>([temp <span class="cf">for</span> gas_data <span class="kw">in</span> virial_data.values() <span class="cf">for</span> temp <span class="kw">in</span> gas_data.keys()])))</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>df_data <span class="op">=</span> []</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> gas <span class="kw">in</span> virial_data.keys():</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>    row <span class="op">=</span> [gas]</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> temp <span class="kw">in</span> all_temps:</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>        row.append(table_data[gas].get(temp, <span class="bu">float</span>(<span class="st">'nan'</span>)))</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>    df_data.append(row)</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>columns <span class="op">=</span> [<span class="st">'Gas'</span>] <span class="op">+</span> [<span class="ss">f&quot;Z at </span><span class="sc">{</span>temp<span class="sc">}</span><span class="ss">, 100 bar&quot;</span> <span class="cf">for</span> temp <span class="kw">in</span> all_temps]</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(df_data, columns<span class="op">=</span>columns)</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a><span class="co"># Save to CSV and create markdown table</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>df.to_csv(<span class="st">'compression_factor_data.csv'</span>, index<span class="op">=</span><span class="va">False</span>, float_format<span class="op">=</span><span class="st">'</span><span class="sc">%.4f</span><span class="st">'</span>)</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a markdown table</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'compression_factor_table.md'</span>, <span class="st">'w'</span>) <span class="im">as</span> f:</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>    f.write(df.to_markdown(index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the table</span></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Compression Factor (Z) Values at 100 bar:</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.to_string(index<span class="op">=</span><span class="va">False</span>, na_rep<span class="op">=</span><span class="st">'-'</span>, float_format<span class="op">=</span><span class="st">'</span><span class="sc">%.4f</span><span class="st">'</span>))</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Figures and data saved successfully.&quot;</span>)</span></code></pre></div>
<h2 id="results">Results</h2>
<p><strong>Table 1.</strong> Compression factor (Z) values at 100 bar for N₂, Ar, CO₂, and CH₄ at various temperatures, calculated using second and third virial coefficients. Values below 1.0 indicate dominant attractive forces, while values above 1.0 indicate dominant repulsive forces.</p>
<table>
<colgroup>
<col style="width: 5%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr>
<th style="text-align: left;">Gas</th>
<th style="text-align: right;">Z at 200K, 100 bar</th>
<th style="text-align: right;">Z at 273K, 100 bar</th>
<th style="text-align: right;">Z at 300K, 100 bar</th>
<th style="text-align: right;">Z at 400K, 100 bar</th>
<th style="text-align: right;">Z at 500K, 100 bar</th>
<th style="text-align: right;">Z at 600K, 100 bar</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">N2</td>
<td style="text-align: right;">0.2145</td>
<td style="text-align: right;">0.9770</td>
<td style="text-align: right;">1.0335</td>
<td style="text-align: right;">1.0709</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">1.0721</td>
</tr>
<tr>
<td style="text-align: left;">Ar</td>
<td style="text-align: right;">0.0816</td>
<td style="text-align: right;">0.9279</td>
<td style="text-align: right;">0.9940</td>
<td style="text-align: right;">1.0648</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">1.0670</td>
</tr>
<tr>
<td style="text-align: left;">CO2</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">0.4429</td>
<td style="text-align: right;">0.5914</td>
<td style="text-align: right;">0.8734</td>
<td style="text-align: right;">0.9785</td>
<td style="text-align: right;">1.0293</td>
</tr>
<tr>
<td style="text-align: left;">CH4</td>
<td style="text-align: right;">0.2636</td>
<td style="text-align: right;">0.8092</td>
<td style="text-align: right;">0.8647</td>
<td style="text-align: right;">0.9853</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">1.0598</td>
</tr>
</tbody>
</table>
<p><img src="../images/compression_factor_comparison.png" alt="Compression factor (Z) as a function of pressure for N₂, Ar, CO₂, and CH₄ at different temperatures" width="800" />
<strong>Figure 1.</strong> Compression factor (Z) as a function of pressure (1-200 bar) for four gases at different temperatures. Dashed lines represent conditions where the second virial coefficient (B) is negative, while solid lines represent positive B values. The horizontal dotted line at Z = 1 indicates ideal gas behavior.</p>
<h2 id="discussion">Discussion</h2>
<p>The computational experiment generated data on compression factor behavior for four common gases across a range of conditions. Table 1 provides compression factor values at 100 bar pressure across different temperatures, revealing characteristic patterns for each gas. At 200K, all gases exhibit strong negative deviations from ideality, with argon showing the most extreme deviation (Z = 0.0816) and methane showing the least extreme (Z = 0.2636). As temperature increases, the compression factors systematically approach and then exceed unity, with nitrogen reaching Z &gt; 1 at 300K, while carbon dioxide requires temperatures of 600K to exhibit Z &gt; 1.</p>
<p>Figure 1 extends this analysis across the entire pressure range, visualizing how compression factors vary with both pressure and temperature. The distinction between dashed lines (negative B values) and solid lines (positive B values) clearly demarcates the transition from attraction-dominated to repulsion-dominated behavior. For nitrogen and argon, this transition occurs between 273K and 300K, while for carbon dioxide, it occurs between 500K and 600K. Methane shows an intermediate behavior, with the transition occurring between 400K and 600K.</p>
<p>The computational results presented in Figure 1 and Table 1 provide a systematic visualization of real gas behavior through the virial equation, revealing characteristic patterns that directly connect to molecular interaction physics. The compression factor profiles demonstrate how different gases respond to changes in temperature and pressure.</p>
<p>At low temperatures (200K), all four gases exhibit strong negative deviations from ideality (Z &lt;&lt; 1), consistent with the dominance of attractive van der Waals forces under these conditions.<span class="citation" data-cites="atkins2010physical"><sup>1</sup></span> The magnitude of these deviations varies significantly between gases, with argon showing the most extreme compression (Z = 0.0816 at 100 bar) and methane exhibiting somewhat less dramatic behavior (Z = 0.2636). This variation correlates with the polarizability and dispersion forces characteristic of each molecule.</p>
<p>As temperature increases, the compression factors systematically approach and then exceed unity, visualizing the transition from attraction-dominated to repulsion-dominated behavior. This transition can be directly traced to the change in sign of the second virial coefficient (B) shown in the legend of Figure 1. The temperature at which B = 0 (and Z ≈ 1 over an extended pressure range) corresponds to the Boyle temperature, a characteristic property of each gas.<span class="citation" data-cites="atkins2010physical"><sup>1</sup></span> From our data, we can estimate approximate Boyle temperatures: ~290K for N₂, ~290-295K for Ar, ~590K for CO₂, and ~500K for CH₄.</p>
<p>Carbon dioxide exhibits particularly interesting behavior, with much stronger deviations from ideality compared to the other gases. At 273K and 100 bar, its compression factor (Z = 0.4429) is less than half the ideal value, and it requires temperatures of 600K to exhibit Z &gt; 1. This exceptional deviation stems from CO₂’s quadrupole moment and capacity for specific orientational interactions, which create stronger and longer-range attractive forces compared to the simple dispersion forces dominant in the other gases studied.<span class="citation" data-cites="atkins2010physical"><sup>1</sup></span> The computational framework implemented in Code 1 successfully captures these molecular-level differences through the magnitude of the virial coefficients.</p>
<p>The pressure dependence shown in Figure 1 also reveals important insights. For gases with negative B values (dashed lines), Z decreases dramatically with increasing pressure, creating steep slopes that would eventually lead to condensation at higher pressures. In contrast, gases with positive B values (solid lines) show a more gradual increase in Z with pressure. This distinction highlights how the virial equation naturally captures the qualitative difference between states where attractive versus repulsive forces dominate.</p>
<p>Examining the data in Table 1, we observe that at intermediate temperatures (273-400K), the compression factors across all four gases span a wide range (0.4429-1.0709), highlighting the limitations of the ideal gas approximation at moderate pressures. The systematic organization of these values demonstrates the practical utility of the virial approach in predicting real gas behavior.</p>
<p>Several limitations of our approach should be acknowledged. The virial equation truncated after the third coefficient becomes increasingly inaccurate at high pressures, particularly near critical conditions.<span class="citation" data-cites="atkins2010physical"><sup>1</sup></span> More sophisticated equations of state would be required for accurate predictions in these regimes. Additionally, our reliance on literature values for the virial coefficients introduces some uncertainty, as experimental determinations can vary between sources.</p>
<h2 id="conclusion">Conclusion</h2>
<p>This computational investigation has provided a systematic visualization of compression factor behavior for four common gases, clearly demonstrating the transition between attractive and repulsive molecular interaction regimes. The virial equation approach successfully captures characteristic differences between gases that directly connect to their molecular properties.</p>
<p>The results quantitatively demonstrate how the second virial coefficient transitions from negative to positive values with increasing temperature, creating a characteristic Boyle temperature unique to each gas. Carbon dioxide was shown to exhibit much stronger deviations from ideality compared to nitrogen, argon, and methane, reflecting its more complex intermolecular interaction landscape.</p>
<p>Future work could extend this approach to include additional gases, particularly those with more complex molecular structures, hydrogen bonding capabilities, or strong polar interactions. The analysis could also be extended to gas mixtures, where cross-virial coefficients introduce additional complexity in the molecular interaction landscape. The computational approach could be enhanced to directly calculate virial coefficients from molecular potentials rather than relying on literature values.</p>
<p>By making the connection between molecular-level interactions and macroscopic behavior visually explicit, this type of computational exploration strengthens intuitive understanding of gas behavior beyond the limitations of the ideal gas approximation.</p>
<h2 class="unnumbered" id="references">References</h2>
<div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list">
<div id="ref-atkins2010physical" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Atkins, P.; Paula, J. de. <em>Physical Chemistry</em>, 9th ed.; W. H. Freeman: New York, 2010.</div>
</div>
</div>
    </section>
</article>
            </div>
        </main>

        <footer>
            <div class="footer-content">
                <div>
                    Site proudly generated by
                    <a href="http://jaspervdj.be/hakyll">Hakyll</a>
                </div>
                
                <button class="print-button">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 6 2 18 2 18 9"></polyline>
                        <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                        <rect x="6" y="14" width="12" height="8"></rect>
                    </svg>
                    Print Article
                </button>
                
                <div>
                    © 2025
                </div>
            </div>
        </footer>
    </body>
</html>